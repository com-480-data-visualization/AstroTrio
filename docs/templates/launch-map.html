{% extends "template.html" %}

{% block title %}AstroTrio - Launch Map{% endblock %}

{% block main %}
<style>
    #main-container {
        display: flex;
        height: 80vh;
        width: 100vw;
    }

    #map-container {
        width: 65%;
        height: 100%;
    }

    #map {
        width: 100%;
        height: 100%;
    }

    #side-panel {
        width: 35%;
        height: 100%;
        background-color: #0d1117;
        color: #00ffe0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        padding: 20px;
        box-sizing: border-box;
        overflow-y: auto;
    }

    #current-year {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 5px;
        text-align: center;
    }

    #chart-box {
        width: 100%;
        height: 500px;
        margin-bottom: 20px;
    }

    #country-chart {
        width: 100% !important;
        height: 100% !important;
    }

    #play-button {
        background-color: #00ffe0;
        color: black;
        border: none;
        border-radius: 8px;
        padding: 0px 3px 1px 3px;
        margin-right: 10px;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0 0 4px #0e4899;
    }

    #year-range {
        flex: 1;
    }

    .button {
    width: 165px;
    border: none;
    border-radius: 4px;
    padding: 8px 12px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }

    #sort-toggle {
        background-color: #00ffe0;
        color: #0d1117;
        margin-left: 20px;
    }

    #status-toggle {
        background-color: #00ff00c1;
        box-shadow: 0 0 10px 2px #00ff00c1;
        color: #0d1117;
        margin-right: 20px;
    }

    #description-box {
        position: absolute;
        top: 200px;
        left: 200px;
        max-width: 350px;
        background-color: #111;
        color: #19dfb8;
        border: 1px solid #19dfb8;
        border-radius: 8px;
        padding: 10px;
        z-index: 9999;
        box-shadow: 0 0 10px rgba(0,0,0,0.3);
        font-size: 14px;
        display: None;
    }

    #description-header {
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    #description-popup {
        font-size: 12px;
        padding: 10px 12px;
        color: #19dfb787;
    }

    #map-info {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: #ffffffdd;
        color: #333;
        border: 1px solid #000000;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        text-align: center;
        line-height: 24px;
        cursor: default;
        font-weight: bold;
        font-size: 16px;
        z-index: 1000;
        }

    #map-info::after {
        content: attr(data-info);
        white-space: pre-line;
        display: none;
        position: absolute;
        top: 30px;
        right: 0;
        background: #c5c5c5;
        color: #000;
        padding: 6px 10px;
        border-radius: 5px;
        border: 1px solid #ccc;
        font-size: 12px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        z-index: 1001;
        max-width: 630px;
        min-width: 550px;
        text-align: left;
    }

    #map-info:hover::after {
    display: block;
    }

</style>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<div id="main-container">
    <!-- Map -->
    <div id="map-container">
        <div id="map">
            <div id="map-info" data-info="This map presents the location of all space mission launches from 1957 to 2022.
            You can sort the launches by success or failure using the button on the side.
            Click on the markers to view details like the launch site name and country.
            The chart on the right presents the evolution of missions over time by country or company.
            By clicking on the bar of a company, you can get some information about it.">i</div>
        </div>
    </div>

    <!-- Panel -->
    <div id="side-panel">
        <!-- Buttons -->
        <div style="display: flex; justify-content: space-between; width: 100%; margin-bottom: 30px;">
            <!-- Sort button -->
            <button id="sort-toggle" class="button">
                Sort: Country
            </button>
        
            <!-- Status button -->
            <button id="status-toggle" class="button">
                Success
            </button>
        </div>
        
        <!-- Graph -->
        <div id="chart-box">
            <canvas id="country-chart"></canvas>
        </div>

        <!-- Time cursor -->
        <div id="current-year">1957</div>
        <div style="display: flex; align-items: center; width: 100%;">
            <div id="play-button">â–¶</div>
            <input type="range" id="year-range" min="1957" max="2022" value="1957">
        </div>
    </div>
</div>

<!-- Description -->
<div id="description-box">
    <div id="description-header"></div>
    <div id="description-popup"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="../static/js/launch_map.js" defer></script>

{% endblock %}
